<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The HCAI42 Framework Infographic with Gemini AI</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (max-width: 768px) {
            .chart-container {
                height: 300px;
            }
        }
        .flow-arrow {
            position: relative;
            width: 100%;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .flow-arrow::after {
            content: '‚ñº';
            font-size: 2rem;
            color: #0d47a1;
        }
        .layer-box {
            border: 2px solid;
            padding: 1rem;
            margin-bottom: 0.5rem;
            border-radius: 0.5rem;
            text-align: center;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        .layer-box:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
        }
        .gemini-button {
            background-color: #1976d2;
            color: white;
            font-weight: bold;
            padding: 10px 20px;
            border-radius: 8px;
            transition: background-color 0.3s;
        }
        .gemini-button:hover {
            background-color: #0d47a1;
        }
        .gemini-button:disabled {
            background-color: #90caf9;
            cursor: not-allowed;
        }
        .chat-message {
            max-width: 70%;
            padding: 12px 16px;
            border-radius: 18px;
            margin-bottom: 8px;
            word-wrap: break-word;
        }
        .user-message {
            background-color: #1976d2;
            color: white;
            margin-left: auto;
            text-align: right;
        }
        .bot-message {
            background-color: #e3f2fd;
            color: #0d47a1;
            border: 1px solid #90caf9;
            margin-right: auto;
            text-align: left;
        }
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #1976d2;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="text-gray-800">

    <!-- Modal for Loading/Error Messages -->
    <div id="messageModal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white p-8 rounded-lg shadow-xl text-center">
            <div id="modalContent">
                <div class="loader mx-auto mb-4"></div>
                <p class="text-lg font-semibold text-gray-700">Generating with Gemini...</p>
            </div>
        </div>
    </div>

    <div class="container mx-auto p-4 md:p-8">

        <header class="text-center mb-16">
            <h1 class="text-4xl md:text-6xl font-black text-[#0d47a1] mb-4">The HCAI42 Framework</h1>
            <p class="text-xl md:text-2xl text-[#1976d2] max-w-4xl mx-auto">A Unified Architecture for Verifiable Value Delivery and Fine-Grained Cost Control</p>
        </header>

        <section id="pillars" class="mb-20">
            <!-- Content is unchanged -->
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-[#0d47a1]">Five Integrated Pillars</h2>
                <p class="text-lg text-gray-600 mt-2">HCAI42 builds on five core concepts to bridge the gap between business strategy and technology execution.</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-md text-center border-t-4 border-[#1976d2]"><div class="text-4xl mb-3">üìù</div><h3 class="font-bold text-lg text-[#0d47a1]">Business Model Canvas</h3><p class="text-sm text-gray-600">Anchoring all work in strategic business value.</p></div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center border-t-4 border-[#2196f3]"><div class="text-4xl mb-3">‚öôÔ∏è</div><h3 class="font-bold text-lg text-[#0d47a1]">Total Learning Architecture</h3><p class="text-sm text-gray-600">A flexible, microservice-based technical backbone.</p></div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center border-t-4 border-[#64b5f6]"><div class="text-4xl mb-3">‚úçÔ∏è</div><h3 class="font-bold text-lg text-[#0d47a1]">Core Information Model</h3><p class="text-sm text-gray-600">Making value propositions a verifiable commitment.</p></div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center border-t-4 border-[#90caf9]"><div class="text-4xl mb-3">üí∞</div><h3 class="font-bold text-lg text-[#0d47a1]">Service-Based Costing</h3><p class="text-sm text-gray-600">Enabling fine-grained, per-service cost control.</p></div>
                <div class="bg-white p-6 rounded-lg shadow-md text-center border-t-4 border-[#bbdefb]"><div class="text-4xl mb-3">ü§ñ</div><h3 class="font-bold text-lg text-[#0d47a1]">AI & BPM Automation</h3><p class="text-sm text-gray-600">Orchestrating and enforcing value delivery.</p></div>
            </div>
        </section>

        <section id="architecture" class="mb-20">
            <!-- Content is unchanged -->
             <div class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
                <div class="text-center mb-8"><h2 class="text-3xl font-bold text-[#0d47a1]">The HCAI42 Layered Model</h2><p class="text-lg text-gray-600 mt-2">A clear separation of concerns, from user-facing interactions down to the core infrastructure.</p></div>
                <div class="max-w-2xl mx-auto">
                    <div class="layer-box" style="border-color: #1976d2; background-color: #e3f2fd;"><h4 class="text-xl font-bold text-[#0d47a1]">Use Case Layer</h4><p class="text-sm text-gray-700">User-facing applications & portals realizing a "Customer Job"</p></div>
                    <div class="flow-arrow"></div>
                    <div class="layer-box" style="border-color: #2196f3; background-color: #e3f2fd;"><h4 class="text-xl font-bold text-[#0d47a1]">Process Layer</h4><p class="text-sm text-gray-700">BPM engines orchestrating end-to-end business workflows</p></div>
                    <div class="flow-arrow"></div>
                    <div class="layer-box" style="border-color: #64b5f6; background-color: #e3f2fd;"><h4 class="text-xl font-bold text-[#0d47a1]">Service Layer</h4><p class="text-sm text-gray-700">TLA microservices exposing discrete business capabilities via APIs</p></div>
                    <div class="flow-arrow"></div>
                    <div class="layer-box" style="border-color: #90caf9; background-color: #e3f2fd;"><h4 class="text-xl font-bold text-[#0d47a1]">Application Layer</h4><p class="text-sm text-gray-700">Core data platforms and persistent stores (LRS, CaSS, XI)</p></div>
                    <div class="flow-arrow"></div>
                    <div class="layer-box" style="border-color: #bbdefb; background-color: #e3f2fd;"><h4 class="text-xl font-bold text-[#0d47a1]">Infrastructure Layer</h4><p class="text-sm text-gray-700">Compute, storage, and network resources (Cloud, Docker, Kafka)</p></div>
                </div>
            </div>
        </section>

        <section id="value-bridge" class="mb-20">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-bold text-[#0d47a1]">The Interactive Value Bridge</h2>
                <p class="text-lg text-gray-600 mt-2">Connect business needs to technical implementation with AI.</p>
            </div>
            <div class="bg-white p-6 rounded-lg shadow-md">
                 <h3 class="text-xl font-bold text-center text-[#0d47a1] mb-4">‚ú® Generate a Value Scenario</h3>
                 <p class="text-gray-600 mb-6 text-center max-w-3xl mx-auto">Enter a customer pain point below. Gemini will analyze it and generate a complete value chain according to the HCAI42 framework, demonstrating how a need is translated into a service-based solution.</p>
                 <div class="max-w-2xl mx-auto mb-8">
                    <div id="chatContainer" class="w-full h-64 p-3 border-2 border-gray-300 rounded-lg overflow-y-auto mb-4 bg-gray-50">
                        <div id="chatMessages" class="space-y-3">
                            <!-- Chat messages will appear here -->
                        </div>
                    </div>
                    <div class="flex gap-2">
                        <textarea id="painPointInput" class="flex-1 p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1976d2] focus:border-transparent transition resize-none" rows="2" placeholder="Enter your message here..."></textarea>
                        <button id="generateScenarioBtn" class="gemini-button px-6 py-2 h-fit self-end">Send</button>
                    </div>
                 </div>
                 <div class="space-y-4 max-w-2xl mx-auto">
                    <div id="painPointOutput" class="p-4 rounded-lg text-center" style="background-color: #e3f2fd; border: 2px solid #90caf9;">
                        <p class="font-bold text-[#0d47a1]">1. Customer Pain Identified</p>
                        <p class="text-sm text-gray-700">"Accessing up-to-date hygiene protocols is slow and unreliable."</p>
                    </div>
                    <div class="flow-arrow"></div>
                    <div id="painRelieverOutput" class="p-4 rounded-lg text-center" style="background-color: #e3f2fd; border: 2px solid #64b5f6;">
                        <p class="font-bold text-[#0d47a1]">2. "Pain Reliever" Defined</p>
                        <p class="text-sm text-gray-700">"Provide on-demand, searchable access to a version-controlled guideline library."</p>
                    </div>
                    <div class="flow-arrow"></div>
                    <div id="tlaServiceOutput" class="p-4 rounded-lg text-center" style="background-color: #e3f2fd; border: 2px solid #2196f3;">
                        <p class="font-bold text-[#0d47a1]">3. TLA Service Mapped</p>
                        <p class="text-sm text-gray-700">The "Activity Resource Management" service is tasked to deliver this value.</p>
                    </div>
                    <div class="flow-arrow"></div>
                    <div id="useCaseOutput" class="p-4 rounded-lg text-center" style="background-color: #e3f2fd; border: 2px solid #1976d2;">
                        <p class="font-bold text-[#0d47a1]">4. Use Case Fulfilled</p>
                        <p class="text-sm text-gray-700">A nurse searches on a tablet and instantly receives the correct protocol via an API call.</p>
                    </div>
                 </div>
            </div>
        </section>
        
        <section id="integrity-cost" class="mb-20">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-bold text-center text-[#0d47a1] mb-4">Value Integrity: The Signed Commitment</h3>
                    <p class="text-gray-600 mb-4 text-center">The Value-CorIM transforms a value proposition into an auditable manifest, allowing programmatic verification against real-world performance data.</p>
                    <div class="chart-container">
                        <canvas id="valueIntegrityChart"></canvas>
                    </div>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg">
                    <h3 class="text-xl font-bold text-center text-[#0d47a1] mb-4">‚ú® Dynamic Economics of Service</h3>
                    <p class="text-gray-600 mb-4 text-center">Enter a service name. Gemini will estimate a plausible cost breakdown, which will be used to update the chart below.</p>
                    <div class="max-w-sm mx-auto mb-4">
                        <input id="serviceNameInput" type="text" class="w-full p-3 border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-[#1976d2] focus:border-transparent transition" placeholder="e.g., 'AI Recommendation Engine'">
                        <button id="estimateCostBtn" class="gemini-button w-full mt-4">Estimate Costs ‚ú®</button>
                    </div>
                    <div class="chart-container">
                        <canvas id="serviceCostChart"></canvas>
                    </div>
                </div>
            </div>
        </section>

        <section id="automation" class="mb-20">
           <!-- Content is unchanged -->
           <div class="bg-white p-6 md:p-8 rounded-lg shadow-lg">
                <div class="text-center mb-8"><h2 class="text-3xl font-bold text-[#0d47a1]">The Automation Engine</h2><p class="text-lg text-gray-600 mt-2">A self-regulating system that ensures value commitments are met.</p></div>
                <div class="relative max-w-5xl mx-auto p-4">
                    <div class="grid md:grid-cols-3 gap-8 text-center">
                        <div class="p-4 rounded-lg" style="background-color: #e3f2fd;"><div class="text-3xl mb-2">üìà</div><h4 class="font-bold text-[#0d47a1]">1. AI Verifier Monitors</h4><p class="text-sm text-gray-700">An AI system continuously collects performance data (Evidence) and compares it to the signed Value-CorIM.</p></div>
                        <div class="p-4 rounded-lg" style="background-color: #e3f2fd;"><div class="text-3xl mb-2">‚ö†Ô∏è</div><h4 class="font-bold text-[#0d47a1]">2. Deviation Detected</h4><p class="text-sm text-gray-700">The AI predicts a service is at risk of failing its promised value (e.g., cost savings are off track).</p></div>
                        <div class="p-4 rounded-lg" style="background-color: #e3f2fd;"><div class="text-3xl mb-2">üöÄ</div><h4 class="font-bold text-[#0d47a1]">3. BPM Workflow Triggered</h4><p class="text-sm text-gray-700">The AI automatically initiates a BPM remediation workflow to take corrective action, creating a self-healing system.</p></div>
                    </div>
                    <div class="hidden md:block absolute top-1/2 left-0 w-full h-1 bg-[#90caf9] -translate-y-1/2 -z-10"></div>
                    <div class="hidden md:block absolute top-1/2 left-1/3 w-0 h-0 border-t-8 border-t-transparent border-b-8 border-b-transparent border-l-8 border-l-[#0d47a1] -translate-y-1/2 -translate-x-4"></div>
                    <div class="hidden md:block absolute top-1/2 left-2/3 w-0 h-0 border-t-8 border-t-transparent border-b-8 border-b-transparent border-l-8 border-l-[#0d47a1] -translate-y-1/2 -translate-x-4"></div>
                </div>
            </div>
        </section>
        
        <footer class="text-center mt-16 py-8 border-t border-gray-300">
            <p class="text-lg font-bold text-[#0d47a1]">HCAI42: Strategy, Technology, and Finance. Unified.</p>
            <p class="text-sm text-gray-500 mt-2">This infographic visualizes the HCAI42 framework, demonstrating a closed loop from strategic intent to verifiable, financially accountable execution.</p>
        </footer>

    </div>

    <script>
        const brilliantBlues = {
            primary: '#0d47a1', secondary: '#1976d2', tertiary: '#2196f3',
            light: '#64b5f6', lighter: '#90caf9', lightest: '#bbdefb', background: '#e3f2fd'
        };

        let serviceCostChart;

        function wrapLabel(str, maxWidth) {
            if (str.length <= maxWidth) return str;
            const words = str.split(' ');
            let lines = [];
            let currentLine = '';
            for (const word of words) {
                if ((currentLine + ' ' + word).trim().length > maxWidth && currentLine.length > 0) {
                    lines.push(currentLine);
                    currentLine = word;
                } else {
                    currentLine = (currentLine + ' ' + word).trim();
                }
            }
            if (currentLine.length > 0) lines.push(currentLine);
            return lines;
        }
        
        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            return Array.isArray(label) ? label.join(' ') : label;
        };
        
        const defaultChartOptions = {
            responsive: true, maintainAspectRatio: false,
            plugins: {
                legend: { position: 'bottom', labels: { color: brilliantBlues.primary, font: { weight: '600' } } },
                tooltip: { callbacks: { title: tooltipTitleCallback } }
            }
        };

        function showModal(content) {
            document.getElementById('modalContent').innerHTML = content;
            document.getElementById('messageModal').classList.remove('hidden');
        }

        function hideModal() {
            document.getElementById('messageModal').classList.add('hidden');
        }

        function showError(message) {
            showModal(`<div class="text-red-600"><p class="text-2xl font-bold mb-2">Error</p><p>${message}</p><button onclick="hideModal()" class="gemini-button mt-4">Close</button></div>`);
        }

        function showLoading(message = 'Generating with Gemini...') {
            showModal(`<div class="loader mx-auto mb-4"></div><p class="text-lg font-semibold text-gray-700">${message}</p>`);
        }

        async function callGemini(payload) {
            const apiKey = ""; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error ? error.error.message : 'API request failed');
                }
                const result = await response.json();
                if (result.candidates && result.candidates.length > 0 && result.candidates[0].content && result.candidates[0].content.parts && result.candidates[0].content.parts.length > 0) {
                    return result.candidates[0].content.parts[0].text;
                } else {
                    throw new Error('Invalid response structure from Gemini API.');
                }
            } catch (error) {
                console.error('Gemini API Error:', error);
                showError(error.message);
                return null;
            }
        }

        function addMessageToChat(message, isUser = false) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `chat-message ${isUser ? 'user-message' : 'bot-message'}`;
            messageDiv.textContent = message;
            chatMessages.appendChild(messageDiv);
            
            const chatContainer = document.getElementById('chatContainer');
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        async function callN8NWebhook(message) {
            try {
                const response = await fetch('https://n8n.hcai42.com/webhook/HCAIstructure', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ message: message })
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const result = await response.text();
                return result;
            } catch (error) {
                console.error('N8N Webhook Error:', error);
                throw error;
            }
        }

        document.getElementById('generateScenarioBtn').addEventListener('click', async () => {
            const painPoint = document.getElementById('painPointInput').value.trim();
            if (!painPoint) {
                showError('Please enter a message.');
                return;
            }

            addMessageToChat(painPoint, true);
            document.getElementById('painPointInput').value = '';
            
            const button = document.getElementById('generateScenarioBtn');
            button.disabled = true;
            button.textContent = 'Sending...';

            try {
                const response = await callN8NWebhook(painPoint);
                addMessageToChat(response, false);
            } catch (error) {
                addMessageToChat('Sorry, I encountered an error processing your request. Please try again.', false);
                showError('Failed to communicate with the service. Please try again.');
            }

            button.disabled = false;
            button.textContent = 'Send';
        });

        document.getElementById('painPointInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter' && !e.shiftKey) {
                e.preventDefault();
                document.getElementById('generateScenarioBtn').click();
            }
        });

        document.getElementById('estimateCostBtn').addEventListener('click', async () => {
            const serviceName = document.getElementById('serviceNameInput').value.trim();
            if (!serviceName) {
                showError('Please enter a service name.');
                return;
            }

            showLoading('Estimating Service Costs...');
            const prompt = `For a hypothetical microservice named "${serviceName}", generate a plausible cost breakdown. Provide five common cost components and their estimated percentage of the total cost. The percentages must add up to 100.`;
            
            const payload = {
                contents: [{ role: "user", parts: [{ text: prompt }] }],
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            "costBreakdown": {
                                type: "ARRAY",
                                items: {
                                    type: "OBJECT",
                                    properties: {
                                        "component": { "type": "STRING" },
                                        "percentage": { "type": "NUMBER" }
                                    },
                                    required: ["component", "percentage"]
                                }
                            }
                        },
                        required: ["costBreakdown"]
                    }
                }
            };
            const responseText = await callGemini(payload);

            if (responseText) {
                try {
                    const result = JSON.parse(responseText);
                    const newLabels = result.costBreakdown.map(item => item.component);
                    const newData = result.costBreakdown.map(item => item.percentage);
                    
                    serviceCostChart.data.labels = [serviceName];
                    serviceCostChart.data.datasets = result.costBreakdown.map((item, index) => ({
                        label: item.component,
                        data: [item.percentage],
                        backgroundColor: Object.values(brilliantBlues)[index % 6]
                    }));
                    serviceCostChart.update();
                } catch (e) {
                    showError('Failed to parse the cost estimation. Please try again.');
                }
            }
            hideModal();
        });

        function initializeCharts() {
            new Chart(document.getElementById('valueIntegrityChart'), {
                type: 'bar',
                data: {
                    labels: ['System Availability', 'Cost Reduction', 'Compliance Score'],
                    datasets: [
                        { label: 'Promised Value (CorIM)', data: [99.95, 30, 100], backgroundColor: brilliantBlues.secondary },
                        { label: 'Delivered Value (Telemetry)', data: [99.97, 32.5, 100], backgroundColor: brilliantBlues.light }
                    ]
                },
                options: { ...defaultChartOptions, scales: { y: { beginAtZero: true, ticks: { callback: v => v + '%', color: brilliantBlues.primary }, grid: { color: '#e0e0e0' } }, x: { ticks: { color: brilliantBlues.primary }, grid: { display: false } } } }
            });
            
            serviceCostChart = new Chart(document.getElementById('serviceCostChart'), {
                type: 'bar',
                data: {
                    labels: ['Competency Mgmt Service'],
                    datasets: [
                        { label: 'Developer Maintenance', data: [45], backgroundColor: brilliantBlues.primary },
                        { label: 'Data Streaming (Kafka)', data: [20], backgroundColor: brilliantBlues.secondary },
                        { label: 'Compute & VM Costs', data: [15], backgroundColor: brilliantBlues.tertiary },
                        { label: 'Data Storage (LRS)', data: [10], backgroundColor: brilliantBlues.light },
                        { label: 'Software Licensing', data: [5], backgroundColor: brilliantBlues.lighter }
                    ]
                },
                options: { ...defaultChartOptions, indexAxis: 'y', scales: { x: { stacked: true, ticks: { callback: v => v + '%', color: brilliantBlues.primary }, grid: { color: '#e0e0e0' } }, y: { stacked: true, ticks: { color: brilliantBlues.primary }, grid: { display: false } } } }
            });
        }

        window.onload = initializeCharts;
    </script>
</body>
</html>
